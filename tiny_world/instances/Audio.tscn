[gd_scene load_steps=8 format=2]

[ext_resource path="res://assets/audio/sounds/478196__jonnyruss01__click-2.wav" type="AudioStream" id=1]
[ext_resource path="res://assets/audio/sounds/constrcution.wav" type="AudioStream" id=2]
[ext_resource path="res://assets/audio/sounds/boom.wav" type="AudioStream" id=3]
[ext_resource path="res://assets/audio/sounds/82378__gynation__paper-flip-2.wav" type="AudioStream" id=4]
[ext_resource path="res://assets/audio/music/Kai_Engel_-_01_-_Brand_New_World.ogg" type="AudioStream" id=5]
[ext_resource path="res://assets/audio/music/Kai_Engel_-_04_-_Sentinel.ogg" type="AudioStream" id=6]

[sub_resource type="GDScript" id=1]
script/source = "extends Node

const FADE = 10.0

enum SOUND { CLICK, CONSTRUCTION, DESTRUCTION, PAPER, WEAK_CLICK }
enum MUSIC { BNW, SENTINEL }

onready var soundDict = {
	SOUND.CLICK: $Sounds/JuicyClick,
	SOUND.CONSTRUCTION: $Sounds/ConstructionNoise,
	SOUND.DESTRUCTION: $Sounds/DestructionNoise,
	SOUND.PAPER: $Sounds/Paper,
	SOUND.WEAK_CLICK: $Sounds/WeakClick,
}

onready var musicDict = {
	MUSIC.BNW: $Music/BrandNewWorld,
	MUSIC.SENTINEL: $Music/Sentinel,
}

var currentlyPlaying:AudioStreamPlayer

func playSound(key:int):
	if soundDict.has(key):
		soundDict[key].stop()
		soundDict[key].play()

func playMusic(key:int):
	if musicDict.has(key):
		$MusicCrossFade.remove_all()
		if currentlyPlaying != null && currentlyPlaying != musicDict.get(key):
			$MusicCrossFade.interpolate_property(currentlyPlaying, \"volume_db\", currentlyPlaying.volume_db, -80, FADE, Tween.TRANS_EXPO, Tween.EASE_IN)
			$MusicCrossFade.interpolate_callback(currentlyPlaying, FADE, \"stop\")
		currentlyPlaying = musicDict.get(key)
		$MusicCrossFade.interpolate_property(currentlyPlaying, \"volume_db\", -80, currentlyPlaying.volume_db, FADE, Tween.TRANS_EXPO, Tween.EASE_OUT)
		$MusicCrossFade.interpolate_callback(currentlyPlaying, 0.1, \"play\")
		$MusicCrossFade.start()
"

[node name="AudioPlayer" type="Node"]
pause_mode = 2
script = SubResource( 1 )

[node name="Sounds" type="Node" parent="."]

[node name="JuicyClick" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource( 1 )

[node name="ConstructionNoise" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource( 2 )

[node name="DestructionNoise" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource( 3 )
volume_db = -5.048

[node name="Paper" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource( 4 )

[node name="WeakClick" type="AudioStreamPlayer" parent="Sounds"]
stream = ExtResource( 4 )
pitch_scale = 2.0

[node name="Music" type="Node" parent="."]

[node name="BrandNewWorld" type="AudioStreamPlayer" parent="Music"]
stream = ExtResource( 5 )

[node name="Sentinel" type="AudioStreamPlayer" parent="Music"]
stream = ExtResource( 6 )

[node name="MusicCrossFade" type="Tween" parent="."]
